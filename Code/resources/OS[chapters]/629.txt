Computer Security Threats

14.1  Computer Security Concepts
14.2  Threats, Attacks, and Assets
      Threats and Attacks
      Threats and Assets
14.3  Intruders
      Intruder Behavior Patterns
      Intrusion Techniques
14.4  Malicious Software Overview
      Backdoor
      Logic Bomb
      Trojan Horse
      Mobile Code
      Multiple-Threat Malware
14.5  Viruses, Worms, and Bots
      Viruses
      Worms
      Bots
14.6  Rootkits
      Rootkit Installation
      System-Level Call Attacks
14.6  Recommended Reading and Web Sites
14.7  Key Terms, Review Questions, and Problems
                                                          607

         The art of war teaches us to rely not on the likelihood of the enemy's
         not coming, but on our own readiness to receive him; not on the chance
         of his not attacking, but rather on the fact that we have made our
         position unassailable.
                                                           --THE ART OF WAR, Sun Tzu
      LEARNING OBJECTIVES
      After studying this chapter, you should be able to:
        List and explain the key concepts that comprise computer security.
        Understand the spectrum of computer security attacks.
        Distinguish among various types of intruder behavior patterns and under-
         stand the types of intrusion techniques used to breach computer security.
        Summarize the principal types of malicious software.
        Present an overview of viruses, including typical virus structure and typical
         virus behavior.
        Understand the security threat posed by worms.
        Understand the security threat posed by bots.
        Explain key aspects of rootkits.
      This chapter provides an overview of security threats. We begin with a discus-
      sion of what we mean by computer security. In essence, computer security deals
      with computer-related assets that are subject to a variety of threats and for which
      various measures are taken to protect those assets. The remainder of the chap-
      ter looks at the two broad categories of computer and network security threats:
      intruders and malicious software.
         Cryptographic algorithms, such as encryption and hash functions, play a role
      both in computer security threats and computer security techniques. Appendix K
      provides an overview of these algorithms.
14.1  COMPUTER SECURITY CONCEPTS
      The NIST Computer Security Handbook [NIST95] defines the term computer
      security as follows:
      Computer security: The protection afforded to an automated information system
      in order to attain the applicable objectives of preserving the integrity, availability,
      and confidentiality of information system resources (includes hardware, software,
      firmware, information/data, and telecommunications).

   This definition introduces three key objectives that are at the heart of compu-
ter security:
  Confidentiality: This term covers two related concepts:
   -- Data1 confidentiality: Assures that private or confidential information is
   not made available or disclosed to unauthorized individuals
   -- Privacy: Assures that individuals control or influence what information
   related to them may be collected and stored and by whom and to whom
   that information may be disclosed
  Integrity: This term covers two related concepts:
   -- Data integrity: Assures that information and programs are changed only in
   a specified and authorized manner
   -- System integrity: Assures that a system performs its intended function in
   an unimpaired manner, free from deliberate or inadvertent unauthorized
   manipulation of the system
  Availability: Assures that systems work promptly and service is not denied to
   authorized users
   These three concepts form what is often referred to as the CIA triad (Figure 14.1).
The three concepts embody the fundamental security objectives for both data and
for information and computing services. For example, the NIST standard FIPS 199
(Standards for Security Categorization of Federal Information and Information Systems)
lists confidentiality, integrity, and availability as the three security objectives for infor-
mation and for information systems. FIPS PUB 199 provides a useful characterization
                        Confidentiality  Data          Integrity
                                         and
                                         services
                                         Availability
                        Figure 14.1  The Security Requirements Triad
1RFC 2828 (Internet Security Glossary) defines information as "facts and ideas, which can be represented
(encoded) as various forms of data," and data as "information in a specific physical representation, usu-
ally a sequence of symbols that have meaning; especially a representation of information that can be
processed or produced by a computer." Security literature typically does not make much of a distinction:
nor does this chapter.

     of these three objectives in terms of requirements and the definition of a loss of security
     in each category:
       Confidentiality: Preserving authorized restrictions on information access
        and disclosure, including means for protecting personal privacy and propri-
        etary information. A loss of confidentiality is the unauthorized disclosure of
        information.
       Integrity: Guarding against improper information modification or destruction,
        including ensuring information nonrepudiation and authenticity. A loss of
        integrity is the unauthorized modification or destruction of information.
       Availability: Ensuring timely and reliable access to and use of information.
        A loss of availability is the disruption of access to or use of information or an
        information system.
        Although the use of the CIA triad to define security objectives is well estab-
     lished, some in the security field feel that additional concepts are needed to present
     a complete picture. Two of the most commonly mentioned are as follows:
       Authenticity: The property of being genuine and being able to be verified and
        trusted; confidence in the validity of a transmission, a message, or message
        originator. This means verifying that users are who they say they are and that
        each input arriving at the system came from a trusted source.
       Accountability: The security goal that generates the requirement for actions
        of an entity to be traced uniquely to that entity. This supports nonrepu-
        diation, deterrence, fault isolation, intrusion detection and prevention,
        and after-action recovery and legal action. Because truly secure systems
        aren't yet an achievable goal, we must be able to trace a security breach to
        a responsible party. Systems must keep records of their activities to permit
        later forensic analysis to trace security breaches or to aid in transaction
        disputes.
        Note that FIPS PUB 199 includes authenticity under integrity.
14.2 THREATS, ATTACKS, AND ASSETS
     We turn now to a look at threats, attacks, and assets as related to computer security.
     Threats and Attacks
     Table 14.1, based on RFC 2828, describes four kinds of threat consequences and
     lists the kinds of attacks that result in each consequence.
        Unauthorized disclosure is a threat to confidentiality. The following types of
     attacks can result in this threat consequence:
       Exposure: This can be deliberate, as when an insider intentionally releases sensi-
        tive information, such as credit card numbers, to an outsider. It can also be the
        result of a human, hardware, or software error, which results in an entity gaining
        unauthorized knowledge of sensitive data. There have been numerous instances

Table 14.1  Threat Consequences, and the Types of Threat Actions that Cause Each Consequence
            (Based on RFC 2828)
Threat Consequence                                  Threat Action (Attack)
Unauthorized Disclosure                             Exposure: Sensitive data are directly released to an
A circumstance or event whereby an entity           unauthorized entity.
gains access to data for which the entity is not    Interception: An unauthorized entity directly
authorized.                                         accesses sensitive data, traveling between authorized
                                                    sources and destinations.
                                                    Inference: A threat action whereby an unauthor-
                                                    ized entity indirectly accesses sensitive data (but not
                                                    necessarily the data contained in the communication)
                                                    by reasoning from characteristics or by-products of
                                                    communications.
                                                    Intrusion: An unauthorized entity gains access to
                                                    sensitive data by circumventing a system's security
                                                    protections.
Deception                                           Masquerade: An unauthorized entity gains access to
A circumstance or event that may result in          a system or performs a malicious act by posing as an
an authorized entity receiving false data and       authorized entity.
believing it to be true.                            Falsification: False data deceive an authorized entity.
                                                    Repudiation: An entity deceives another by falsely
                                                    denying responsibility for an act.
Disruption                                          Incapacitation: Prevents or interrupts system opera-
A circumstance or event that interrupts or          tion by disabling a system component.
prevents the correct operation of system services   Corruption: Undesirably alters system operation by
and functions.                                      adversely modifying system functions or data.
                                                    Obstruction: A threat action that interrupts delivery
                                                    of system services by hindering system operation.
Usurpation                                          Misappropriation: An entity assumes unauthorized
A circumstance or event that results in control of  logical or physical control of a system resource.
system services or functions by an unauthorized     Misuse: Causes a system component to perform a func-
entity.                                             tion or service that is detrimental to system security.
               of this, such as universities accidentally posting student confidential information
               on the Web.
              Interception: Interception is a common attack in the context of communica-
               tions. On a shared local area network (LAN), such as a wireless LAN or a
               broadcast Ethernet, any device attached to the LAN can receive a copy of
               packets intended for another device. On the Internet, a determined hacker
               can gain access to e-mail traffic and other data transfers. All of these situations
               create the potential for unauthorized access to data.
              Inference: An example of inference is known as traffic analysis, in which an
               adversary is able to gain information from observing the pattern of traffic on
               a network, such as the amount of traffic between particular pairs of hosts on
               the network. Another example is the inference of detailed information from
               a database by a user who has only limited access; this is accomplished by
               repeated queries whose combined results enable inference.

      Intrusion: An example of intrusion is an adversary gaining unauthorized access
        to sensitive data by overcoming the system's access control protections.
        Deception is a threat to either system integrity or data integrity. The following
     types of attacks can result in this threat consequence:
       Masquerade: One example of masquerade is an attempt by an unauthor-
        ized user to gain access to a system by posing as an authorized user; this
        could happen if the unauthorized user has learned another user's logon ID
        and password. Another example is malicious logic, such as a Trojan horse,
        that appears to perform a useful or desirable function but actually gains
        unauthorized access to system resources or tricks a user into executing other
        malicious logic.
       Falsification: This refers to the altering or replacing of valid data or the intro-
        duction of false data into a file or database. For example, a student may alter
        his or her grades on a school database.
       Repudiation: In this case, a user either denies sending data or a user denies
        receiving or possessing the data.
        Disruption is a threat to availability or system integrity. The following types of
     attacks can result in this threat consequence:
       Incapacitation: This is an attack on system availability. This could occur as a
        result of physical destruction of or damage to system hardware. More typically,
        malicious software, such as Trojan horses, viruses, or worms, could operate in
        such a way as to disable a system or some of its services.
       Corruption: This is an attack on system integrity. Malicious software in this
        context could operate in such a way that system resources or services func-
        tion in an unintended manner. Or a user could gain unauthorized access to
        a system and modify some of its functions. An example of the latter is a user
        placing backdoor logic in the system to provide subsequent access to a system
        and its resources by other than the usual procedure.
       Obstruction: One way to obstruct system operation is to interfere with com-
        munications by disabling communication links or altering communication
        control information. Another way is to overload the system by placing excess
        burden on communication traffic or processing resources.
        Usurpation is a threat to system integrity. The following types of attacks can
     result in this threat consequence:
       Misappropriation: This can include theft of service. An example is a distrib-
        uted denial of service attack, when malicious software is installed on a number
        of hosts to be used as platforms to launch traffic at a target host. In this case,
        the malicious software makes unauthorized use of processor and operating
        system resources.
       Misuse: Misuse can occur either by means of malicious logic or a hacker that
        has gained unauthorized access to a system. In either case, security functions
        can be disabled or thwarted.

   Threats and Assets
   The assets of a computer system can be categorized as hardware, software, data,
   and communication lines and networks. In this subsection, we briefly describe these
   four categories and relate these to the concepts of integrity, confidentiality, and
   availability introduced in Section 14.1 (see Figure 14.2 and Table 14.2).
   HARDWARE                   A  major    threat     to    computer  system      hardware  is  the  threat     to
   availability. Hardware is the most vulnerable to attack and the least susceptible to
   automated controls. Threats include accidental and deliberate damage to equipment
   as well as theft. The proliferation of personal computers and workstations and the
   widespread use of LANs increase the potential for losses in this area. Theft of
   CD-ROMs and DVDs can lead to loss of confidentiality. Physical and administrative
   security measures are needed to deal with these threats.
   SOFTWARE                   Software includes the operating system, utilities, and application
   programs. A key threat to software is an attack on availability. Software, especially
   application software, is often easy to delete. Software can also be altered or
   damaged to render it useless. Careful software configuration management, which
   includes making backups of the most recent version of software, can maintain high
   availability. A more difficult problem to deal with is software modification that
   results in a program that still functions but that behaves differently than before,
   which is a threat to integrity/authenticity. Computer viruses and related attacks fall
   into this category. A final problem is protection against software piracy. Although
                       Computer system                                           Computer system
                                       4  Sensitive files
                                          must be secure
                                 Data     (file security)                               Data
1  Access to the data                                      3      Data must be
   must be controlled                                      securely transmitted
   (protection)                                            through networks
                                                           (network security)
                       Processes representing users                              Processes representing users
                       Guard                                                     Guard
                                 2        Access to the computer
                                       facility must be controlled
                                          (user authentication)
                              Users making requests
Figure 14.2  Scope of System Security

Table  14.2  Computer  and Network Assets, with Examples of Threats
                       Availability            Confidentiality         Integrity
             Hardware  Equipment is stolen or
                       disabled, thus denying
                       service.
             Software  Programs are deleted,   An unauthorized copy    A working program is modi-
                       denying access to       of software is made.    fied, either to cause it to fail
                       users.                                          during execution or to cause
                                                                       it to do some unintended task.
             Data      Files are deleted,      An unauthorized read    Existing files are modified or
                       denying access to       of data is performed.   new files are fabricated.
                       users.                  An analysis of sta-
                                               tistical data reveals
                                               underlying data.
Communication Lines    Messages are            Messages are read.      Messages are modified,
                       destroyed or deleted.   The traffic pattern of  delayed, reordered, or dupli-
                       Communication lines     messages is observed.   cated. False messages are
                       or networks are ren-                            fabricated.
                       dered unavailable.
       certain countermeasures are available, by and large the problem of unauthorized
       copying of software has not been solved.
       DATA  Hardware and software security are typically concerns of computing center
       professionals or individual concerns of personal computer users. A much more
       widespread problem is data security, which involves files and other forms of data
       controlled by individuals, groups, and business organizations.
             Security concerns with respect to data are broad, encompassing availability,
       secrecy, and integrity. In the case of availability, the concern is with the destruction
       of data files, which can occur either accidentally or maliciously.
             The obvious concern with secrecy is the unauthorized reading of data files or
       databases, and this area has been the subject of perhaps more research and effort
       than any other area of computer security. A less obvious threat to secrecy involves
       the analysis of data and manifests itself in the use of so-called statistical databases,
       which provide summary or aggregate information. Presumably, the existence of
       aggregate information does not threaten the privacy of the individuals involved.
       However, as the use of statistical databases grows, there is an increasing potential
       for disclosure of personal information. In essence, characteristics of constituent
       individuals may be identified through careful analysis. For example, if one table
       records the aggregate of the incomes of respondents A, B, C, and D and another
       records the aggregate of the incomes of A, B, C, D, and E, the difference between
       the two aggregates would be the income of E. This problem is exacerbated by the
       increasing desire to combine data sets. In many cases, matching several sets of data
       for consistency at different levels of aggregation requires access to individual units.
       Thus, the individual units, which are the subject of privacy concerns, are available at
       various stages in the processing of data sets.

Finally, data integrity is a major concern in most installations. Modifications
to data files can have consequences ranging from minor to disastrous.
COMMUNICATION LINES AND NETWORKS            Network security attacks can be classified
as passive attacks and active attacks. A passive attack attempts to learn or make
use of information from the system but does not affect system resources. An active
attack attempts to alter system resources or affect their operation.
Passive attacks are in the nature of eavesdropping on, or monitoring of, trans-
missions. The goal of the attacker is to obtain information that is being transmitted.
Two types of passive attacks are release of message contents and traffic analysis.
The concept of release of message contents is easily understood. A telephone
conversation, an electronic mail message, and a transferred file may contain sensitive
or confidential information. We would like to prevent an opponent from learning the
contents of these transmissions.
Traffic analysis is a more subtle form of passive attack. Suppose that we had a
way of masking the contents of messages or other information traffic so that oppo-
nents, even if they captured the message, could not extract the information from
the message. The common technique for masking contents is encryption. If we had
encryption protection in place, an opponent might still be able to observe the pat-
tern of these messages. The opponent could determine the location and identity of
communicating hosts and could observe the frequency and length of messages being
exchanged. This information might be useful in guessing the nature of the commu-
nication that was taking place.
Passive attacks are very difficult to detect because they do not involve any
alteration of the data. Typically, the message traffic is sent and received in an appar-
ently normal fashion, and neither the sender nor the receiver is aware that a third
party has read the messages or observed the traffic pattern. However, it is feasible
to prevent the success of these attacks, usually by means of encryption. Thus, the
emphasis in dealing with passive attacks is on prevention rather than detection.
Active attacks involve some modification of the data stream or the creation
of a false stream and can be subdivided into four categories: replay, masquerade,
modification of messages, and denial of service.
Replay involves the passive capture of a data unit and its subsequent retrans-
mission to produce an unauthorized effect.
A masquerade takes place when one entity pretends to be a different entity. A
masquerade attack usually includes one of the other forms of active attack. For exam-
ple, authentication sequences can be captured and replayed after a valid authentica-
tion sequence has taken place, thus enabling an authorized entity with few privileges
to obtain extra privileges by impersonating an entity that has those privileges.
Modification of messages simply means that some portion of a legitimate
message is altered, or that messages are delayed or reordered, to produce an
unauthorized effect. For example, a message stating, "Allow John Smith to read con-
fidential file accounts" is modified to say, "Allow Fred Brown to read confidential
file accounts."
The denial of service prevents or inhibits the normal use or management of
communications facilities. This attack may have a specific target; for example, an
entity may suppress all messages directed to a particular destination (e.g., the security

     audit service). Another form of service denial is the disruption of an entire network,
     either by disabling the network or by overloading it with messages so as to degrade
     performance.
        Active attacks present the opposite characteristics of passive attacks. Whereas
     passive attacks are difficult to detect, measures are available to prevent their suc-
     cess. On the other hand, it is quite difficult to prevent active attacks absolutely,
     because to do so would require physical protection of all communications facilities
     and paths at all times. Instead, the goal is to detect them and to recover from any
     disruption or delays caused by them. Because the detection has a deterrent effect, it
     may also contribute to prevention.
14.3 INTRUDERS
     The concept of intruder was introduced in Section 3.6. [GRAN04] lists the follow-
     ing examples of intrusion:
       Performing a remote root compromise of an e-mail server
       Defacing a Web server
       Guessing and cracking passwords
       Copying a database containing credit card numbers
       Viewing sensitive data, including payroll records and medical information,
        without authorization
       Running a packet sniffer on a workstation to capture usernames and passwords
       Using a permission error on an anonymous FTP server to distribute pirated
        software and music files
       Dialing into an unsecured modem and gaining internal network access
       Posing as an executive, calling the help desk, resetting the executive's e-mail
        password, and learning the new password
       Using an unattended, logged-in workstation without permission
     Intruder Behavior Patterns
     The techniques and behavior patterns of intruders are constantly shifting, to exploit
     newly discovered weaknesses and to evade detection and countermeasures. Even
     so, intruders typically follow one of a number of recognizable behavior patterns,
     and these patterns typically differ from those of ordinary users. In the following,
     we look at three broad examples of intruder behavior patterns to give the reader
     some feel for the challenge facing the security administrator. Table 14.3, based on
     [RADC04], summarizes the behavior.
     HACKERS  Traditionally, those who hack into computers do so for the thrill of
     it or for status. The hacking community is a strong meritocracy in which status
     is determined by level of competence. Thus, attackers often look for targets of
     opportunity and then share the information with others. A typical example is a

Table 14.3  Some Examples of Intruder Patterns of Behavior
                                               (a) Hacker
1.  Select the target using IP lookup tools such as NSLookup, Dig, and others.
2.  Map network for accessible services using tools such as NMAP.
3.  Identify potentially vulnerable services (in this case, pcAnywhere).
4.  Brute force (guess) pcAnywhere password.
5.  Install remote administration tool called DameWare.
6.  Wait for administrator to log on and capture his or her password.
7.  Use that password to access remainder of network.
                                        (b) Criminal Enterprise
1.  Act quickly and precisely to make their activities harder to detect.
2.  Exploit perimeter through vulnerable ports.
3.  Use Trojan horses (hidden software) to leave backdoors for reentry.
4.  Use sniffers to capture passwords.
5.  Do not stick around until noticed.
6.  Make few or no mistakes.
                                          (c) Internal Threat
1.  Create network accounts for themselves and their friends.
2.  Access accounts and applications they wouldn't normally use for their daily jobs.
3.  E-mail former and prospective employers.
4.  Conduct furtive instant-messaging chats.
5.  Visit Web sites that cater to disgruntled employees, such as f'dcompany.com.
6.  Perform large downloads and file copying.
7.  Access the network during off hours.
break-in at a large financial institution reported in [RADC04]. The intruder took
advantage of the fact that the corporate network was running unprotected services,
some of which were not even needed. In this case, the key to the break-in was the
pcAnywhere application. The manufacturer, Symantec, advertises this program as
a remote control solution that enables secure connection to remote devices. But the
attacker had an easy time gaining access to pcAnywhere; the administrator used the
same three-letter username and password for the program. In this case, there was
no intrusion detection system on the 700-node corporate network. The intruder was
only discovered when a vice president walked into her office and saw the cursor
moving files around on her Windows workstation.
    Benign intruders might be tolerable, although they do consume resources and
may slow performance for legitimate users. However, there is no way in advance to
know whether an intruder will be benign or malign. Consequently, even for systems
with no particularly sensitive resources, there is a motivation to control this problem.
    Intrusion detection systems (IDSs) and intrusion prevention systems (IPSs),
of the type described in this Chapter 15, are designed to counter this type of hacker
threat. In addition to using such systems, organizations can consider restricting
remote logons to specific IP addresses and/or use virtual private network technology.

     One of the results of the growing awareness of the intruder problem has been
     the establishment of a number of computer emergency response teams (CERTs).
     These cooperative ventures collect information about system vulnerabilities and
     disseminate it to systems managers. Hackers also routinely read CERT reports.
     Thus, it is important for system administrators to quickly insert all software patches
     to discovered vulnerabilities. Unfortunately, given the complexity of many IT
     systems and the rate at which patches are released, this is increasingly difficult to
     achieve without automated updating. Even then, there are problems caused by
     incompatibilities resulting from the updated software (hence the need for multiple
     layers of defense in managing security threats to IT systems).
     CRIMINALS       Organized groups of hackers have become a widespread and common
     threat to Internet-based systems. These groups can be in the employ of a corporation
     or government but often are loosely affiliated gangs of hackers. Typically, these
     gangs are young, often Eastern European, Russian, or southeast Asian hackers who
     do business on the Web [ANTE06]. They meet in underground forums with names
     like DarkMarket.org and theftservices.com to trade tips and data and coordinate
     attacks. A common target is a credit card file at an e-commerce server. Attackers
     attempt to gain root access. The card numbers are used by organized crime gangs
     to purchase expensive items and are then posted to carder sites, where others can
     access and use the account numbers; this obscures usage patterns and complicates
     investigation.
     Whereas traditional hackers look for targets of opportunity, criminal hack-
     ers usually have specific targets, or at least classes of targets in mind. Once a site is
     penetrated, the attacker acts quickly, scooping up as much valuable information as
     possible and exiting.
     IDSs and IPSs can also be used for these types of attackers but may be less
     effective because of the quick in-and-out nature of the attack. For e-commerce
     sites, database encryption should be used for sensitive customer information,
     especially credit cards. For hosted e-commerce sites (provided by an outsider
     service), the e-commerce organization should make use of a dedicated server (not
     used to support multiple customers) and closely monitor the provider's security
     services.
     INSIDER    ATTACKS     Insider attacks are among the most difficult to detect and
     prevent. Employees already have access to and knowledge of the structure and
     content of corporate databases. Insider attacks can be motivated by revenge or
     simply a feeling of entitlement. An example of the former is the case of Kenneth
     Patterson, fired from his position as data communications manager for American
     Eagle Outfitters. Patterson disabled the company's ability to process credit card
     purchases during 5 days of the holiday season of 2002. As for a sense of entitlement,
     there have always been many employees who felt entitled to take extra office
     supplies for home use, but this now extends to corporate data. An example is that of
     a vice president of sales for a stock analysis firm who quit and went to a competitor.
     Before she left, she copied the customer database to take with her. The offender
     reported feeling no animus toward her former employee; she simply wanted the
     data because it would be useful to her.

         Although IDS and IPS facilities can be useful in countering insider attacks,
      other more direct approaches are of higher priority. Examples include the following:
        Enforce least privilege, only allowing access to the resources employees need
         to do their job.
        Set logs to see what users access and what commands they are entering.
        Protect sensitive resources with strong authentication.
        Upon termination, delete employee's computer and network access.
        Upon termination, make a mirror image of employee's hard drive before reis-
         suing it. That evidence might be needed if your company information turns up
         at a competitor.
      Intrusion Techniques
      The objective of the intruder is to gain access to a system or to increase the range of
      privileges accessible on a system. Most initial attacks use system or software vulner-
      abilities that allow a user to execute code that opens a back door into the system.
      Intruders can get access to a system by exploiting attacks such as buffer overflows
      on a program that runs with certain privileges.
         Alternatively, the intruder attempts to acquire information that should have
      been protected. In some cases, this information is in the form of a user password.
      With knowledge of some other user's password, an intruder can log in to a system
      and exercise all the privileges accorded to the legitimate user. Password guessing
      and password acquisition techniques are discussed in Chapter 15.
14.4  MALICIOUS SOFTWARE OVERVIEW
      The concept of malicious software, or malware, was introduced in Section 3.6. Malware
      is software designed to cause damage to or use up the resources of a target computer.
      It is frequently concealed within or masquerades as legitimate software. In some cases,
      it spreads itself to other computers via e-mail or infected discs. The terminology in this
      area presents problems because of a lack of universal agreement on all of the terms
      and because some of the categories overlap. Table 14.4 is a useful guide.
         In this section, we briefly survey some of the key categories of malicious soft-
      ware, deferring discussion on the key topics of viruses, worms, bots, and rootkits
      until the following sections.
      Backdoor
      A backdoor, also known as a trapdoor, is a secret entry point into a program
      that allows someone who is aware of the backdoor to gain access without going
      through the usual security access procedures. Programmers have used backdoors
      legitimately for many years to debug and test programs; such a backdoor is called
      a maintenance hook. This usually is done when the programmer is developing an
      application that has an authentication procedure, or a long setup, requiring the user
      to enter many different values to run the application. To debug the program, the

Table 14.4    Terminology  of Malicious Programs
Name                       Description
Virus                      Malware that, when executed, tries to replicate itself into other executable
                           code; when it succeeds the code is said to be infected. When the infected code is
                           executed, the virus also executes.
Worm                       A computer program that can run independently and can propagate a complete
                           working version of itself onto other hosts on a network.
Logic bomb                 A program inserted into software by an intruder. A logic bomb lies dormant until
                           a predefined condition is met; the program then triggers an unauthorized act.
Trojan horse               A computer program that appears to have a useful function but also has a hidden
                           and potentially malicious function that evades security mechanisms, sometimes
                           by exploiting legitimate authorizations of a system entity that invokes the Trojan
                           horse program.
Backdoor (trapdoor)        Any mechanism that bypasses a normal security check; it may allow unauthorized
                           access to functionality.
Mobile code                Software (e.g., script, macro, or other portable instruction) that can be shipped
                           unchanged to a heterogeneous collection of platforms and execute with identical
                           semantics.
Exploits                   Code specific to a single vulnerability or set of vulnerabilities.
Downloaders                Program that installs other items on a machine that is under attack. Usually, a
                           downloader is sent in an e-mail.
Auto-rooter                Malicious hacker tools used to break into new machines remotely.
Kit (virus generator)      Set of tools for generating new viruses automatically.
Spammer programs           Used to send large volumes of unwanted e-mail.
Flooders                   Used to attack networked computer systems with a large volume of traffic to
                           carry out a denial-of-service (DoS) attack.
Keyloggers                 Captures keystrokes on a compromised system.
Rootkit                    Set of hacker tools used after attacker has broken into a computer system and
                           gained root-level access.
Zombie, bot                Program activated on an infected machine that is activated to launch attacks on
                           other machines.
Spyware                    Software that collects information from a computer and transmits it to another
                           system.
Adware                     Advertising that is integrated into software. It can result in pop-up ads or
                           redirection of a browser to a commercial site.
          developer may wish to gain special privileges or to avoid all the necessary setup and
          authentication. The programmer may also want to ensure that there is a method of
          activating the program should something be wrong with the authentication proce-
          dure that is being built into the application. The backdoor is code that recognizes
          some special sequence of input or is triggered by being run from a certain user ID or
          by an unlikely sequence of events.
              Backdoors become threats when unscrupulous programmers use them to
          gain unauthorized access. The backdoor was the basic idea for the vulnerability

portrayed in the movie War Games. Another example is that during the develop-
ment of Multics, penetration tests were conducted by an Air Force "tiger team"
(simulating adversaries). One tactic employed was to send a bogus operating system
update to a site running Multics. The update contained a Trojan horse (described
later) that could be activated by a backdoor and that allowed the tiger team to gain
access. The threat was so well implemented that the Multics developers could not
find it, even after they were informed of its presence [ENGE80].
It is difficult to implement operating system controls for backdoors. Security
measures must focus on the program development and software update activities.
Logic Bomb
One of the oldest types of program threat, predating viruses and worms, is the logic
bomb. The logic bomb is code embedded in some legitimate program that is set to
"explode" when certain conditions are met. Examples of conditions that can be used
as triggers for a logic bomb are the presence or absence of certain files, a particular
day of the week or date, or a particular user running the application. Once triggered,
a bomb may alter or delete data or entire files, cause a machine halt, or do some
other damage. A striking example of how logic bombs can be employed was the
case of Tim Lloyd, who was convicted of setting a logic bomb that cost his employer,
Omega Engineering, more than $10 million, derailed its corporate growth strategy,
and eventually led to the layoff of 80 workers [GAUD00]. Ultimately, Lloyd was
sentenced to 41 months in prison and ordered to pay $2 million in restitution.
Trojan Horse
A Trojan horse is a useful, or apparently useful, program or command procedure
containing hidden code that, when invoked, performs some unwanted or harmful
function.
Trojan horse programs can be used to accomplish functions indirectly that an
unauthorized user could not accomplish directly. For example, to gain access to the
files of another user on a shared system, a user could create a Trojan horse program
that, when executed, changes the invoking user's file permissions so that the files
are readable by any user. The author could then induce users to run the program by
placing it in a common directory and naming it such that it appears to be a useful
utility program or application. An example is a program that ostensibly produces
a listing of the user's files in a desirable format. After another user has run the
program, the author of the program can then access the information in the user's
files. An example of a Trojan horse program that would be difficult to detect is a
compiler that has been modified to insert additional code into certain programs as
they are compiled, such as a system login program [THOM84]. The code creates a
backdoor in the login program that permits the author to log on to the system using
a special password. This Trojan horse can never be discovered by reading the source
code of the login program.
Another common motivation for the Trojan horse is data destruction. The
program appears to be performing a useful function (e.g., a calculator program),
but it may also be quietly deleting the user's files. For example, a CBS executive
was victimized by a Trojan horse that destroyed all information contained in his

     computer's memory [TIME90]. The Trojan horse was implanted in a graphics rou-
     tine offered on an electronic bulletin board system.
        Trojan horses fit into one of three models:
       Continuing to perform the function of the original program and additionally
        performing a separate malicious activity
       Continuing to perform the function of the original program but modifying the
        function to perform malicious activity (e.g., a Trojan horse version of a login
        program that collects passwords) or to disguise other malicious activity (e.g., a
        Trojan horse version of a process listing program that does not display certain
        processes that are malicious)
       Performing a malicious function that completely replaces the function of the
        original program
     Mobile Code
     Mobile code refers to programs (e.g., script, macro, or other portable instruction)
     that can be shipped unchanged to a heterogeneous collection of platforms and exe-
     cute with identical semantics [JANS01]. The term also applies to situations involving
     a large homogeneous collection of platforms (e.g., Microsoft Windows).
        Mobile code is transmitted from a remote system to a local system and then
     executed on the local system without the user's explicit instruction. Mobile code
     often acts as a mechanism for a virus, worm, or Trojan horse to be transmitted
     to the user's workstation. In other cases, mobile code takes advantage of vulner-
     abilities to perform its own exploits, such as unauthorized data access or root
     compromise. Popular vehicles for mobile code include Java applets, ActiveX,
     JavaScript, and VBScript. The most common ways of using mobile code for
     malicious operations on local system are cross-site scripting, interactive and
     dynamic Web sites, e-mail attachments, and downloads from untrusted sites or
     of untrusted software.
     Multiple-Threat Malware
     Viruses and other malware may operate in multiple ways. The terminology is far
     from uniform; this subsection gives a brief introduction to several related concepts
     that could be considered multiple-threat malware.
        A multipartite virus infects in multiple ways. Typically, the multipartite virus
     is capable of infecting multiple types of files, so that virus eradication must deal with
     all of the possible sites of infection.
        A blended attack uses multiple methods of infection or transmission, to maxi-
     mize the speed of contagion and the severity of the attack. Some writers characterize
     a blended attack as a package that includes multiple types of malware. An example
     of a blended attack is the Nimda attack, erroneously referred to as simply a worm.
     Nimda uses four distribution methods:
       E-mail: A user on a vulnerable host opens an infected e-mail attachment;
        Nimda looks for e-mail addresses on the host and then sends copies of itself to
        those addresses.

        Windows shares: Nimda scans hosts for unsecured Windows file shares; it can
         then use NetBIOS86 as a transport mechanism to infect files on that host in
         the hopes that a user will run an infected file, which will activate Nimda on
         that host.
        Web servers: Nimda scans Web servers, looking for known vulnerabilities in
         Microsoft IIS. If it finds a vulnerable server, it attempts to transfer a copy of
         itself to the server and infect it and its files.
        Web clients: If a vulnerable Web client visits a Web server that has been
         infected by Nimda, the client's workstation will become infected.
         Thus, Nimda has worm, virus, and mobile code characteristics. Blended attacks
      may also spread through other services, such as instant messaging and peer-to-peer
      file sharing.
14.5  VIRUSES,WORMS, AND BOTS
      Viruses
      A computer virus is a piece of software that can "infect" other programs by modify-
      ing them; the modification includes injecting the original program with a routine to
      make copies of the virus program, which can then go on to infect other programs.
         Biological viruses are tiny scraps of genetic code--DNA or RNA--that can
      take over the machinery of a living cell and trick it into making thousands of flaw-
      less replicas of the original virus. Like its biological counterpart, a computer virus
      carries in its instructional code the recipe for making perfect copies of itself. The
      typical virus becomes embedded in a program on a computer. Then, whenever the
      infected computer comes into contact with an uninfected piece of software, a fresh
      copy of the virus passes into the new program. Thus, the infection can be spread
      from computer to computer by unsuspecting users who either swap disks or send
      programs to one another over a network. In a network environment, the ability
      to access applications and system services on other computers provides a perfect
      culture for the spread of a virus.
      THE NATURE OF VIRUSES  A virus can do anything that other programs do. The
      only difference is that it attaches itself to another program and executes secretly
      when the host program is run. Once a virus is executing, it can perform any function
      that is allowed by the privileges of the current user, such as erasing files and
      programs.
         A computer virus has three parts [AYCO06]:
        Infection mechanism: The means by which a virus spreads, enabling it to rep-
         licate. The mechanism is also referred to as the infection vector.
        Trigger: The event or condition that determines when the payload is activated
         or delivered.
        Payload: What the virus does, besides spreading. The payload may involve
         damage or may involve benign but noticeable activity.

        During its lifetime, a typical virus goes through the following four phases:
       Dormant phase: The virus is idle. The virus will eventually be activated by
        some event, such as a date, the presence of another program or file, or the
        capacity of the disk exceeding some limit. Not all viruses have this stage.
       Propagation phase: The virus places an identical copy of itself into other pro-
        grams or into certain system areas on the disk. Each infected program will
        now contain a clone of the virus, which will itself enter a propagation phase.
       Triggering phase: The virus is activated to perform the function for which it
        was intended. As with the dormant phase, the triggering phase can be caused
        by a variety of system events, including a count of the number of times that
        this copy of the virus has made copies of itself.
       Execution phase: The function is performed. The function may be harm-
        less, such as a message on the screen, or damaging, such as the destruction of
        programs and data files.
        Most viruses carry out their work in a manner that is specific to a particular
     operating system and, in some cases, specific to a particular hardware platform. Thus,
     they are designed to take advantage of the details and weaknesses of particular
     systems.
     VIRUS  STRUCTURE  A virus can be prepended or postpended to an executable
     program, or it can be embedded in some other fashion. The key to its operation is
     that the infected program, when invoked, will first execute the virus code and then
     execute the original code of the program.
        A very general depiction of virus structure is shown in Figure 14.3 (based on
     [COHE94]). In this case, the virus code, V, is prepended to infected programs, and
     it is assumed that the entry point to the program, when invoked, is the first line of
     the program.
        The infected program begins with the virus code and works as follows. The
     first line of code is a jump to the main virus program. The second line is a special
     marker that is used by the virus to determine whether or not a potential victim
     program has already been infected with this virus. When the program is invoked,
     control is immediately transferred to the main virus program. The virus program
     may first seek out uninfected executable files and infect them. Next, the virus may
     perform some action, usually detrimental to the system. This action could be per-
     formed every time the program is invoked, or it could be a logic bomb that triggers
     only under certain conditions. Finally, the virus transfers control to the original pro-
     gram. If the infection phase of the program is reasonably rapid, a user is unlikely
     to notice any difference between the execution of an infected and an uninfected
     program.
        A virus such as the one just described is easily detected because an infected
     version of a program is longer than the corresponding uninfected one. A way to
     thwart such a simple means of detecting a virus is to compress the executable file
     so that both the infected and uninfected versions are of identical length. Figure 14.4
     [COHE94] shows in general terms the logic required. The important lines in this
     virus are numbered. We assume that program P1 is infected with the virus CV. When

       program    V  :=
{goto   main;
        1234567;
       subroutine    infect-executable           :=
         {loop:
         file        :=  get-random-executable-file;
         if     (first-line-of-file          =   1234567)
                then     goto  loop
                else     prepend   V  to  file;      }
       subroutine    do-damage     :=
         {whatever       damage    is    to  be  done}
       subroutine    trigger-pulled          :=
         {return         true  if  some   condition     holds}
main:       main-program       :=
         {infect-executable;
         if     trigger-pulled        then   do-damage;
         goto        next;}
next:
}
Figure 14.3     A Simple Virus
this program is invoked, control passes to its virus, which performs the following
steps:
   1.   For each uninfected file P2 that is found, the virus first compresses that file to
        produce P'2, which is shorter than the original program by the size of the virus.
   2.   A copy of the virus is prepended to the compressed program.
program     CV  :=
{goto   main;
        01234567;
        subroutine       infect-executable       :=
                {loop:
                         file  :=    get-random-executable-file;
                if   (first-line-of-file         =   01234567)  then  goto  loop;
             (1)         compress     file;
             (2)         prepend   CV    to  file;
         }
main:        main-program      :=
                {if  ask-permission       then      infect-executable;
             (3)         uncompress      rest-of-file;
             (4)         run   uncompressed      file;}
         }
Figure 14.4     Logic for a Compression Virus

     3.  The compressed version of the original infected program, P'1, is uncompressed.
     4.  The uncompressed original program is executed.
         In this example, the virus does nothing other than propagate. As previously
     mentioned, the virus may include a logic bomb.
     INITIAL INFECTION  Once a virus has gained entry to a system by infecting a single
     program, it is in a position to potentially infect some or all other executable files
     on that system when the infected program executes. Thus, viral infection can be
     completely prevented by preventing the virus from gaining entry in the first place.
     Unfortunately, prevention is extraordinarily difficult because a virus can be part
     of any program outside a system. Thus, unless one is content to take an absolutely
     bare piece of iron and write all one's own system and application programs, one is
     vulnerable. Many forms of infection can also be blocked by denying normal users
     the right to modify programs on the system.
         The lack of access controls on early PCs is a key reason that traditional
     machine code based viruses spread rapidly on these systems. In contrast, while it
     is easy enough to write a machine code virus for UNIX systems, they were almost
     never seen in practice, because the existence of access controls on these systems
     prevented effective propagation of the virus. Traditional machine code based
     viruses are now less prevalent, because modern PC operating systems have more
     effective access controls. However, virus creators have found other avenues, such as
     macro and e-mail viruses, as discussed subsequently.
     VIRUSES CLASSIFICATION   There has been a continuous arms race between virus
     writers and writers of antivirus software since viruses first appeared. As effective
     countermeasures are developed for existing types of viruses, newer types are
     developed. There is no simple or universally agreed-upon classification scheme
     for viruses. In this section, we follow [AYCO06] and classify viruses along two
     orthogonal axes: the type of target the virus tries to infect, and the method the
     virus uses to conceal itself from detection by users and antivirus software.
         A virus classification by target includes the following categories:
        Boot sector infector: Infects a master boot record or boot record and spreads
         when a system is booted from the disk containing the virus
        File infector: Infects files that the operating system or shell considers to be
         executable
        Macro virus: Infects files with macro code that is interpreted by an application
         A virus classification by concealment strategy includes the following categories:
        Encrypted virus: A typical approach is as follows. A portion of the virus
         creates a random encryption key and encrypts the remainder of the virus.
         The key is stored with the virus. When an infected program is invoked, the
         virus uses the stored random key to decrypt the virus. When the virus rep-
         licates, a different random key is selected. Because the bulk of the virus is
         encrypted with a different key for each instance, there is no constant bit
         pattern to observe.

 Stealth virus: A form of virus explicitly designed to hide itself from detection
    by antivirus software. Thus, the entire virus, not just a payload is hidden.
 Polymorphic virus: A virus that mutates with every infection, making detec-
    tion by the "signature" of the virus impossible.
   Metamorphic virus: As with a polymorphic virus, a metamorphic virus mutates
    with every infection. The difference is that a metamorphic virus rewrites itself
    completely at each iteration, increasing the difficulty of detection. Metamorphic
    viruses may change their behavior as well as their appearance.
    One example of a stealth virus was discussed earlier: A virus that uses com-
pression so that the infected program is exactly the same length as an uninfected
version. Far more sophisticated techniques are possible. For example, a virus can
place intercept logic in disk I/O routines, so that when there is an attempt to read
suspected portions of the disk using these routines, the virus will present back the
original, uninfected program. Thus, stealth is not a term that applies to a virus as
such but, rather, refers to a technique used by a virus to evade detection.
    A polymorphic virus creates copies during replication that are functionally
equivalent but have distinctly different bit patterns. As with a stealth virus, the
purpose is to defeat programs that scan for viruses. In this case, the "signature" of
the virus will vary with each copy. To achieve this variation, the virus may randomly
insert superfluous instructions or interchange the order of independent instruc-
tions. A more effective approach is to use encryption. The strategy of the encryption
virus is followed. The portion of the virus that is responsible for generating keys and
performing encryption/decryption is referred to as the mutation engine. The muta-
tion engine itself is altered with each use.
VIRUS KITS  Another weapon in the virus writers' armory is the virus-creation
toolkit. Such a toolkit enables a relative novice to quickly create a number of
different viruses. Although viruses created with toolkits tend to be less sophisticated
than viruses designed from scratch, the sheer number of new viruses that can be
generated using a toolkit creates a problem for antivirus schemes.
MACRO VIRUSES  In the mid-1990s, macro viruses became by far the most prevalent
type of virus. Macro viruses are particularly threatening for a number of reasons:
1.  A macro virus is platform independent. Many macro viruses infect Microsoft
    Word documents or other Microsoft Office documents. Any hardware platform
    and operating system that supports these applications can be infected.
2.  Macro viruses infect documents, not executable portions of code. Most of the
    information introduced onto a computer system is in the form of a document
    rather than a program.
3.  Macro viruses are easily spread. A very common method is by electronic mail.
4.  Because macro viruses infect user documents rather than system programs, tra-
    ditional file system access controls are of limited use in preventing their spread.
    Macro viruses take advantage of a feature found in Word and other Office
applications such as Microsoft Excel--namely, the macro. In essence, a macro is an
executable program embedded in a word processing document or other type of file.

     Typically, users employ macros to automate repetitive tasks and thereby save key-
     strokes. The macro language is usually some form of the Basic programming language.
     A user might define a sequence of keystrokes in a macro and set it up so that the
     macro is invoked when a function key or special short combination of keys is input.
         Successive releases of MS Office products provide increased protection
     against macro viruses. For example, Microsoft offers an optional Macro Virus
     Protection tool that detects suspicious Word files and alerts the customer to the
     potential risk of opening a file with macros. Various antivirus product vendors
     have also developed tools to detect and correct macro viruses. As in other types of
     viruses, the arms race continues in the field of macro viruses, but they no longer are
     the predominant virus threat.
     E-MAIL VIRUSES  A more recent development in malicious software is the e-mail
     virus. The first rapidly spreading e-mail viruses, such as Melissa, made use of
     a Microsoft Word macro embedded in an attachment. If the recipient opens the
     e-mail attachment, the Word macro is activated. Then
     1.  The e-mail virus sends itself to everyone on the mailing list in the user's e-mail
         package.
     2.  The virus does local damage on the user's system.
         In 1999, a more powerful version of the e-mail virus appeared. This newer
     version can be activated merely by opening an e-mail that contains the virus rather
     than opening an attachment. The virus uses the Visual Basic scripting language
     supported by the e-mail package.
         Thus we see a new generation of malware that arrives via e-mail and uses
     e-mail software features to replicate itself across the Internet. The virus propa-
     gates itself as soon as it is activated (either by opening an e-mail attachment or by
     opening the e-mail) to all of the e-mail addresses known to the infected host. As a
     result, whereas viruses used to take months or years to propagate, they now do so
     in hours. This makes it very difficult for antivirus software to respond before much
     damage is done. Ultimately, a greater degree of security must be built into Internet
     utility and application software on PCs to counter the growing threat.
     Worms
     A worm is a program that can replicate itself and send copies from computer to
     computer across network connections. Upon arrival, the worm may be activated to
     replicate and propagate again. In addition to propagation, the worm usually performs
     some unwanted function. An e-mail virus has some of the characteristics of a worm
     because it propagates itself from system to system. However, we can still classify it as a
     virus because it uses a document modified to contain viral macro content and requires
     human action. A worm actively seeks out more machines to infect, and each machine
     that is infected serves as an automated launching pad for attacks on other machines.
         Network worm programs use network connections to spread from system to
     system. Once active within a system, a network worm can behave as a computer
     virus or bacteria, or it could implant Trojan horse programs or perform any number
     of disruptive or destructive actions.

    To replicate itself, a network worm uses some sort of network vehicle.
Examples include the following:
   Electronic mail facility: A worm mails a copy of itself to other systems, so that
    its code is run when the e-mail or an attachment is received or viewed.
   Remote execution capability: A worm executes a copy of itself on another
    system, either using an explicit remote execution facility or by exploiting a
    program flaw in a network service to subvert its operations (such as buffer
    overflow, described in Chapter 7).
   Remote login capability: A worm logs on to a remote system as a user and
    then uses commands to copy itself from one system to the other, where it then
    executes.
The new copy of the worm program is then run on the remote system where, in
addition to any functions that it performs at that system, it continues to spread in
the same fashion.
    A network worm exhibits the same characteristics as a computer virus: a
dormant phase, a propagation phase, a triggering phase, and an execution phase.
The propagation phase generally performs the following functions:
1.  Search for other systems to infect by examining host tables or similar reposi-
    tories of remote system addresses.
2.  Establish a connection with a remote system.
3.  Copy itself to the remote system and cause the copy to be run.
    The network worm may also attempt to determine whether a system has pre-
viously been infected before copying itself to the system. In a multiprogramming
system, it may also disguise its presence by naming itself as a system process or using
some other name that may not be noticed by a system operator.
    As with viruses, network worms are difficult to counter.
WORM PROPAGATION MODEL           [ZOU05] describes a model for worm propagation
based on an analysis of recent worm attacks. The speed of propagation and the
total number of hosts infected depend on a number of factors, including the mode
of propagation, the vulnerability or vulnerabilities exploited, and the degree of
similarity to preceding attacks. For the latter factor, an attack that is a variation of a
recent previous attack may be countered more effectively than a more novel attack.
Figure 14.5 shows the dynamics for one typical set of parameters. Propagation proceeds
through three phases. In the initial phase, the number of hosts increases exponentially.
To see that this is so, consider a simplified case in which a worm is launched from a
single host and infects two nearby hosts. Each of these hosts infects two more hosts,
and so on. This results in exponential growth. After a time, infecting hosts waste some
time attacking already infected hosts, which reduces the rate of infection. During this
middle phase, growth is approximately linear, but the rate of infection is rapid. When
most vulnerable computers have been infected, the attack enters a slow finish phase
as the worm seeks out those remaining hosts that are difficult to identify.
    Clearly, the objective in countering a worm is to catch the worm in its slow
start phase, at a time when few hosts have been infected.

                                        5    105
                                        4.5
                                                                                            Slow finish
                                        4                                                         phase
              Number of infected hosts  3.5
                                        3
                                        2.5
                                                                                     Fast spread
                                        2                                            phase
                                        1.5       Slow start
                                        1         phase
                                        0.5
                                                  100         200  300               400          500    600
                                                                   Time t (minutes)
              Figure 14.5                         Worm Propagation Model
     STATE OF WORM TECHNOLOGY                                 The state of the art in worm technology includes
     the following:
       Multiplatform: Newer worms are not limited to Windows machines but can
        attack a variety of platforms, especially the popular varieties of UNIX.
       Multiexploit: New worms penetrate systems in a variety of ways, using exploits
        against Web servers, browsers, e-mail, file sharing, and other network-based
        applications.
       Ultrafast spreading: One technique to accelerate the spread of a worm is to
        conduct a prior Internet scan to accumulate Internet addresses of vulnerable
        machines.
       Polymorphic: To evade detection, skip past filters, and foil real-time analysis,
        worms adopt the virus polymorphic technique. Each copy of the worm has
        new code generated on the fly using functionally equivalent instructions and
        encryption techniques.
       Metamorphic: In addition to changing their appearance, metamorphic worms
        have a repertoire of behavior patterns that are unleashed at different stages of
        propagation.
       Transport vehicles: Because worms can rapidly compromise a large number
        of systems, they are ideal for spreading other distributed attack tools, such as
        distributed denial of service bots.
       Zero-day exploit: To achieve maximum surprise and distribution, a worm
        should exploit an unknown vulnerability that is only discovered by the general
        network community when the worm is launched.

Bots
A bot (robot), also known as a zombie or drone, is a program that secretly takes
over another Internet-attached computer and then uses that computer to launch
attacks that are difficult to trace to the bot's creator. The bot is typically planted on
hundreds or thousands of computers belonging to unsuspecting third parties. The
collection of bots often is capable of acting in a coordinated manner; such a collec-
tion is referred to as a botnet.
      A botnet exhibits three characteristics: the bot functionality, a remote control
facility, and a spreading mechanism to propagate the bots and construct the botnet.
We examine each of these characteristics in turn.
USES OF BOTS  [HONE05] lists the following uses of bots:
 Distributed denial-of-service (DDoS) attacks: A DDoS attack is an attack on
      a computer system or network that causes a loss of service to users.
     Spamming: With the help of a botnet and thousands of bots, an attacker is able
      to send massive amounts of bulk e-mail (spam).
     Sniffing traffic: Bots can also use a packet sniffer to watch for interesting clear-
      text data passing by a compromised machine. The sniffers are mostly used to
      retrieve sensitive information like usernames and passwords.
     Keylogging: If the compromised machine uses encrypted communication
      channels (e.g., HTTPS or POP3S), then just sniffing the network packets on
      the victim's computer is useless because the appropriate key to decrypt the
      packets is missing. But by using a keylogger, which captures keystrokes on the
      infected machine, an attacker can retrieve sensitive information. An imple-
      mented filtering mechanism (e.g., "I am only interested in key sequences near
      the keyword `paypal.com' ") further helps in stealing secret data.
     Spreading new malware: Botnets are used to spread new bots. This is very
      easy since all bots implement mechanisms to download and execute a file via
      HTTP or FTP. A botnet with 10,000 hosts that acts as the start base for a
      worm or mail virus allows very fast spreading and thus causes more harm.
     Installing advertisement add-ons and browser helper objects (BHOs): Botnets
      can also be used to gain financial advantages. This works by setting up a fake
      Web site with some advertisements: The operator of this Web site negotiates a
      deal with some hosting companies that pay for clicks on ads. With the help of
      a botnet, these clicks can be "automated" so that instantly a few thousand bots
      click on the pop-ups. This process can be further enhanced if the bot hijacks
      the start page of a compromised machine so that the "clicks" are executed
      each time the victim uses the browser.
     Attacking IRC chat networks: Botnets are also used for attacks against
      Internet Relay Chat (IRC) networks. Popular among attackers is especially
      the so-called clone attack: In this kind of attack, the controller orders each bot
      to connect a large number of clones to the victim IRC network. The victim is
      flooded by service requests from thousands of bots or thousands of channel-
      joins by these cloned bots. In this way, the victim IRC network is brought
      down, similar to a DDoS attack.

        Manipulating online polls/games: Online polls/games are getting more and
         more attention, and it is rather easy to manipulate them with botnets. Since
         every bot has a distinct IP address, every vote will have the same credibil-
         ity as a vote cast by a real person. Online games can be manipulated in a
         similar way.
     REMOTE CONTROL FACILITY  The remote control facility is what distinguishes a
     bot from a worm. A worm propagates itself and activates itself, whereas a bot is
     controlled from some central facility, at least initially.
         A typical means of implementing the remote control facility is on an IRC
     server. All bots join a specific channel on this server and treat incoming messages
     as commands. More recent botnets tend to avoid IRC mechanisms and use covert
     communication channels via protocols such as HTTP. Distributed control mecha-
     nisms are also used, to avoid a single point of failure.
         Once a communications path is established between a control module and the
     bots, the control module can activate the bots. In its simplest form, the control mod-
     ule simply issues command to the bot that causes the bot to execute routines that
     are already implemented in the bot. For greater flexibility, the control module can
     issue update commands that instruct the bots to download a file from some Internet
     location and execute it. The bot in this latter case becomes a more general-purpose
     tool that can be used for multiple attacks.
     CONSTRUCTING THE ATTACK NETWORK              The first step in a botnet attack is for the
     attacker to infect a number of machines with bot software that will ultimately be
     used to carry out the attack. The essential ingredients in this phase of the attack are
     the following:
     1.  Software that can carry out the attack. The software must be able to run on
         a large number of machines, must be able to conceal its existence, must be
         able to communicate with the attacker or have some sort of time-triggered
         mechanism, and must be able to launch the intended attack toward the
         target.
     2.  A vulnerability in a large number of systems. The attacker must become aware
         of a vulnerability that many system administrators and individual users have
         failed to patch and that enables the attacker to install the bot software.
     3.  A strategy for locating and identifying vulnerable machines, a process known
         as scanning or fingerprinting.
         In the scanning process, the attacker first seeks out a number of vulnerable
     machines and infects them. Then, typically, the bot software that is installed in
     the infected machines repeats the same scanning process, until a large distributed
     network of infected machines is created. [MIRK04] lists the following types of
     scanning strategies:
        Random: Each compromised host probes random addresses in the IP address
         space, using a different seed. This technique produces a high volume of
         Internet traffic, which may cause generalized disruption even before the actual
         attack is launched.

        Hit list: The attacker first compiles a long list of potential vulnerable machines.
         This can be a slow process done over a long period to avoid detection that an
         attack is underway. Once the list is compiled, the attacker begins infecting
         machines on the list. Each infected machine is provided with a portion of the
         list to scan. This strategy results in a very short scanning period, which may
         make it difficult to detect that infection is taking place.
        Topological: This method uses information contained on an infected victim
         machine to find more hosts to scan.
        Local subnet: If a host can be infected behind a firewall, that host then looks
         for targets in its own local network. The host uses the subnet address structure
         to find other hosts that would otherwise be protected by the firewall.
14.6  ROOTKITS
      A rootkit is a set of programs installed on a system to maintain administrator (or
      root) access to that system. Root access provides access to all the functions and
      services of the operating system. The rootkit alters the host's standard functionality
      in a malicious and stealthy way. With root access, an attacker has complete control
      of the system and can add or change programs and files, monitor processes, send
      and receive network traffic, and get backdoor access on demand.
         A rootkit can make many changes to a system to hide its existence, mak-
      ing it difficult for the user to determine that the rootkit is present and to iden-
      tify what changes have been made. In essence, a rootkit hides by subverting the
      mechanisms that monitor and report on the processes, files, and registries on a
      computer.
         Rootkits can be classified based on whether they can survive a reboot and
      execution mode. A rootkit may be
        Persistent: Activates each time the system boots. The rootkit must store code
         in a persistent store, such as the registry or file system, and configure a method
         by which the code executes without user intervention.
        Memory based: Has no persistent code and therefore cannot survive a reboot
        User mode: Intercepts calls to APIs (Application Program Interfaces) and mod-
         ifies returned results. For example, when an application performs a directory
         listing, the return results don't include entries identifying the files associated
         with the rootkit.
        Kernel mode: Can intercept calls to native APIs in kernel mode. The root-
         kit can also hide the presence of a malware process by removing it from the
         kernel's list of active processes.
      Rootkit Installation
      Unlike worms or bots, rootkits do not directly rely on vulnerabilities or exploits
      to get on a computer. One method of rootkit installation is via a Trojan horse pro-
      gram. The user is induced to load the Trojan horse, which then installs the rootkit.

     Another means of rootkit installation is by hacker activity. The following sequence
     is representative of a hacker attack to install a rootkit [GEER06].
     1.      The attacker uses a utility to identify open ports or other vulnerabilities.
     2.      The attacker uses password cracking, malware, or a system vulnerability to
             gain initial access and, eventually, root access.
     3.      The attacker uploads the rootkit to the victim's machine.
     4.      The attacker can add a virus, denial of service, or other type of attack to the
             rootkit's payload.
     5.      The attacker then runs the rootkit's installation script.
     6.      The rootkit replaces binaries, files, commands, or system utilities to hide its
             presence.
     7.      The rootkit listens at a port in the target server, installs sniffers or keyloggers,
             activates a malicious payload, or takes other steps to compromise the victim.
     System-Level Call Attacks
     Programs operating at the user level interact with the kernel through system calls.
     Thus, system calls are a primary target of kernel-level rootkits to achieve conceal-
     ment. As an example of how rootkits operate, we look at the implementation of
     system calls in Linux. In Linux, each system call is assigned a unique syscall number.
     When a user-mode process executes a system call, the process refers to the system
     call by this number. The kernel maintains a system call table with one entry per
     system call routine; each entry contains a pointer to the corresponding routine. The
     syscall number serves as an index into the system call table.
             [LEVI06] lists three techniques that can be used to change system calls:
            Modify the system call table: The attacker modifies selected syscall addresses
             stored in the system call table. This enables the rootkit to direct a system call
             away from the legitimate routine to the rootkit's replacement. Figure 14.6
             shows how the knark rootkit achieves this.
            Modify system call table targets: The attacker overwrites selected legitimate
             system call routines with malicious code. The system call table is not changed.
     System call table                             System call table      knark_fork( )
                                                                          knark_read( )
                                                                          knark_execve( )
     #2                                                  #2
     #3                                                  #3
     #11                              sys_fork( )        #11                             sys_fork( )
     #12                              sys_read( )        #12                             sys_read( )
                                 sys_execve( )                            sys_execve( )
                                 sys_chdir( )                             sys_chdir( )
     (a) Normal kernel memory layout                            (b) After knark install
Figure 14.6  System Call Table Modification by Rootkit

          Redirect the system call table: The attacker redirects references to the entire
           system call table to a new table in a new kernel memory location.
14.6    RECOMMENDED READING AND WEB SITES
        The topics in this chapter are covered in more detail in [STAL08]. It is useful to
        read some of the classic tutorial papers on computer security; these provide a his-
        torical perspective from which to appreciate current work and thinking. The papers
        to read are [WARE79], [BROW72], [SALT75], [SHAN77], and [SUMM84]. Two
        more recent short treatments of computer security are [ANDR04] and [LAMP04].
        [NIST95] is an exhaustive (290 pages) treatment of the subject. Another good treat-
        ment is [NRC91]. Also useful is [FRAS97].
ANDR04  Andrews, M., and Whittaker, J. "Computer Security." IEEE Security and Privacy,
      September/October 2004.
BROW72     Browne, P. "Computer Security--A Survey." ACM SIGMIS Database, Fall 1972.
FRAS97  Fraser, B. Site Security Handbook. RFC 2196, September 1997.
LAMP04  Lampson, B. "Computer Security in the Real World." Computer, June 2004.
NIST95  National Institute of Standards and Technology. An Introduction to Computer Security:
      The NIST Handbook. Special Publication 800-12. October 1995.
NRC91   National Research Council. Computers at Risk: Safe Computing in the Information Age.
      Washington, DC: National Academy Press, 1991.
SALT75  Saltzer, J., and Schroeder, M. "The Protection of Information in Computer Systems."
      Proceedings of the IEEE, September 1975.
SHAN77  Shanker, K. "The Total Computer Security Problem: An Overview." Computer, June 1977.
STAL08  Stallings, W., and Brown L. Computer Security: Principles and Practice. Upper Saddle
      River, NJ: Prentice Hall, 2008.
SUMM84     Summers, R. "An Overview of Computer Security." IBM Systems Journal, Vol. 23,
      No. 4, 1984.
WARE79     Ware, W., ed. Security Controls for Computer Systems. RAND Report 609-1,
      October 1979. http://www.rand.org/pubs/reports/R609-1/index2.html
        Recommended Web sites:
          Computer Security Resource Center: Maintained by the National Institute on Stan-
           dards and Technology (NIST). Contains a broad range of information on security
           threats, technology, and standards.
          CERT Coordination Center: The organization that grew from the computer emergency
           response team formed by the Defense Advanced Research Projects Agency. Site provides
           good information on Internet security threats, vulnerabilities, and attack statistics.
          Vmyths: Dedicated to exposing virus hoaxes and dispelling misconceptions about real
           viruses.

14.7 KEY TERMS, REVIEW QUESTIONS, AND PROBLEMS
Key Terms
accountability                   e-mail virus                             passive attack
active attack                    falsification                            privacy
asset                            hacker                                   replay
attack                           insider attack                           repudiation
authenticity                     integrity                                system integrity
availability                     interception                             threat
backdoor                         intruder                                 traffic analysis
confidentiality                  intrusion                                trapdoor
data integrity                   logic bomb                               Trojan horse
deception                        macro virus                              usurpation
denial of service                malicious software                       virus
disruption                       malware                                  virus kit
exposure                         masquerade                               worm
        Review Questions
        14.1     Define computer security.
        14.2     What are the fundamental requirements addressed by computer security?
        14.3     What is the difference between passive and active security threats?
        14.4     List and briefly define three classes of intruders.
        14.5     List and briefly define three intruder behavior patterns.
        14.6     What is the role of compression in the operation of a virus?
        14.7     What is the role of encryption in the operation of a virus?
        14.8     What are typical phases of operation of a virus or worm?
        14.9     In general terms, how does a worm propagate?
        14.10    What is the difference between a bot and a rootkit?
        Problems
        14.1     Consider an automated teller machine (ATM) in which users provide a personal iden-
                 tification number (PIN) and a card for account access. Give examples of confidenti-
                 ality, integrity, and availability requirements associated with the system and, in each
                 case, indicate the degree of importance of the requirement.
        14.2     Repeat the preceding problem for a telephone switching system that routes calls
                 through a switching network based on the telephone number requested by the caller.
        14.3     Consider a desktop     publishing  system    used    to  produce     documents  for  various
                 organizations.
                 a.  Give an example of a type of publication for which confidentiality of the stored
                     data is the most important requirement.
                 b.  Give an example of a type of publication in which data integrity is the most impor-
                     tant requirement.
                 c.  Give an example in which system availability is the most important requirement.

14.4  For each of the following assets, assign a low, moderate, or high impact level for the
      loss of confidentiality, availability, and integrity, respectively. Justify your answers.
      a.  An organization managing public information on its Web server.
      b.  A  law  enforcement    organization  managing    extremely    sensitive  investigative
          information.
      c.  A financial organization managing routine administrative information (not privacy-
          related information).
      d.  An information system used for large acquisitions in a contracting organization
          contains both sensitive, pre-solicitation phase contract information and routine
          administrative information. Assess the impact for the two data sets separately and
          the information system as a whole.
      e.  A power plant contains a SCADA (supervisory control and data acquisition)
          system controlling the distribution of electric power for a large military installation.
          The SCADA system contains both real-time sensor data and routine administra-
          tive information. Assess the impact for the two data sets separately and the infor-
          mation system as a whole.
14.5  Assume that passwords are selected from four-character combinations of 26 alpha-
      betic characters. Assume that an adversary is able to attempt passwords at a rate of
      one per second.
      a.  Assuming no feedback to the adversary until each attempt has been completed,
          what is the expected time to discover the correct password?
      b.  Assuming feedback to the adversary flagging an error as each incorrect character
          is entered, what is the expected time to discover the correct password?
14.6  There is a flaw in the virus program of Figure 14.1. What is it?
14.7  The question arises as to whether it is possible to develop a program that can analyze
      a piece of software to determine if it is a virus. Consider that we have a program D
      that is supposed to be able to do that. That is, for any program P, if we run D(P), the
      result returned is TRUE (P is a virus) or FALSE (P is not a virus). Now consider the
      following program:
                  Program    CV     :=
                     {  ...
                     main-program       :=
                                 {if    D(CV)  then   goto  next:
                                            else  infect-executable;
                                 }
                  next:
                  }
      In the preceding program, infect-executable is a module that scans memory for exe-
      cutable programs and replicates itself in those programs. Determine if D can correctly
      decide whether CV is a virus.
14.8  The point of this problem is to demonstrate the type of puzzles that must be solved in
      the design of malicious code and therefore, the type of mind-set that one wishing to
      counter such attacks must adopt.
      a.  Consider the following C program:
                  begin
                         print      (*begin    print  ();   end.*);
                  end
          What do you think the program was intended to do? Does it work?

            b.  Answer the same questions for the following program:
                char [] = {'0', ' ', '}', ';', 'm', 'a',               'i',  'n',  '(',  ')',  '{',
                and so on...  't',    ')',    '0'};
                main          ()
                {
                      int         I;
                      printf(*char            t[]     =   (*);
                      for         (i=0;  t[i]!=0;         i=i+1)
                                  printf("%d,         ",  t[i]);
                      printf("%s",            t);
                }
            c.  What is the specific relevance of this problem to this chapter?
     14.9   Consider the following fragment:
                legitimate            code
                if    data        is  Friday  the        13th;
                      crash_computer();
                legitimate            code
            What type of malicious software is this?
     14.10  Consider the following fragment in an authentication program:
                username          =   read_username();
                password          =   read_password();
                if    username        is      "133t   h4ck0r"
                      return          ALLOW_LOGIN;
                if    username        and     password    are     valid
                      return          ALLOW_LOGIN
                else  return          DENY_LOGIN
            What type of malicious software is this?
     14.11  The following code fragments show a sequence of virus instructions and a polymor-
            phic version of the virus. Describe the effect produced by the metamorphic code.
                Original Code                      Metamorphic Code
                mov   eax,    5                    mov    eax,    5
                add   eax,    ebx                  push   ecx
                call  [eax]                        pop    ecx
                                                   add    eax,    ebx
                                                   swap   eax,       ebx
                                                   swap   ebx,       eax
                                                   call   [eax]
                                                   nop

