File Sharing
540  CHAPTER 12 / FILE MANAGEMENT
12.5 FILE SHARING
     In a multiuser system, there is almost always a requirement for allowing files to be
     shared among a number of users. Two issues arise: access rights and the manage-
     ment of simultaneous access.
     Access Rights
     The file system should provide a flexible tool for allowing extensive file sharing
     among users. The file system should provide a number of options so that the way
     in which a particular file is accessed can be controlled. Typically, users or groups
     of users are granted certain access rights to a file. A wide range of access rights has
     been used. The following list is representative of access rights that can be assigned
     to a particular user for a particular file:
       None: The user may not even learn of the existence of the file, much less
        access it. To enforce this restriction, the user would not be allowed to read the
        user directory that includes this file.
       Knowledge: The user can determine that the file exists and who its owner is.
        The user is then able to petition the owner for additional access rights.
       Execution: The user can load and execute a program but cannot copy it.
        Proprietary programs are often made accessible with this restriction.
       Reading: The user can read the file for any purpose, including copying and
        execution. Some systems are able to enforce a distinction between viewing
        and copying. In the former case, the contents of the file can be displayed to the
        user, but the user has no means for making a copy.
       Appending: The user can add data to the file, often only at the end, but cannot
        modify or delete any of the file's contents. This right is useful in collecting data
        from a number of sources.
       Updating: The user can modify, delete, and add to the file's data. This normally
        includes writing the file initially, rewriting it completely or in part, and remov-
        ing all or a portion of the data. Some systems distinguish among different
        degrees of updating.
       Changing protection: The user can change the access rights granted to other
        users. Typically, this right is held only by the owner of the file. In some systems,
        the owner can extend this right to others. To prevent abuse of this mechanism,
        the file owner will typically be able to specify which rights can be changed by
        the holder of this right.
       Deletion: The user can delete the file from the file system.
        These rights can be considered to constitute a hierarchy, with each right imply-
     ing those that precede it. Thus, if a particular user is granted the updating right for a
     particular file, then that user is also granted the following rights: knowledge, execu-
     tion, reading, and appending.

                                            12.6 / RECORD BLOCKING                                       541
         One user is designated as owner of a given file, usually the person who initially
      created a file. The owner has all of the access rights listed previously and may grant
      rights to others. Access can be provided to different classes of users:
        Specific user: Individual users who are designated by user ID
        User groups: A set of users who are not individually defined. The system must
         have some way of keeping track of the membership of user groups.
        All: All users who have access to this system. These are public files.
      Simultaneous Access
      When access is granted to append or update a file to more than one user, the oper-
      ating system or file management system must enforce discipline. A brute-force
      approach is to allow a user to lock the entire file when it is to be updated. A finer
      grain of control is to lock individual records during update. Essentially, this is the
      readers/writers problem discussed in Chapter 5. Issues of mutual exclusion and
      deadlock must be addressed in designing the shared access capability.
12.6  RECORD BLOCKING
      As indicated in Figure 12.2, records are the logical unit of access of a structured file,3
      whereas blocks are the unit of I/O with secondary storage. For I/O to be performed,
      records must be organized as blocks.
         There are several issues to consider. First, should blocks be of fixed or vari-
      able length? On most systems, blocks are of fixed length. This simplifies I/O, buffer
      allocation in main memory, and the organization of blocks on secondary storage.
      Second, what should the relative size of a block be compared to the average record
      size? The trade-off is this: The larger the block, the more records that are passed
      in one I/O operation. If a file is being processed or searched sequentially, this is an
      advantage, because the number of I/O operations is reduced by using larger blocks,
      thus speeding up processing. On the other hand, if records are being accessed ran-
      domly and no particular locality of reference is observed, then larger blocks result in
      the unnecessary transfer of unused records. However, combining the frequency of
      sequential operations with the potential for locality of reference, we can say that the
      I/O transfer time is reduced by using larger blocks. The competing concern is that
      larger blocks require larger I/O buffers, making buffer management more difficult.
         Given the size of a block, there are three methods of blocking that can be used:
        Fixed blocking: Fixed-length records are used, and an integral number of
         records are stored in a block. There may be unused space at the end of each
         block. This is referred to as internal fragmentation.
        Variable-length spanned blocking: Variable-length records are used and are
         packed into blocks with no unused space. Thus, some records must span two
         blocks, with the continuation indicated by a pointer to the successor block.
      3As opposed to a file that is treated only as a stream of bytes, such as in the UNIX file system.
